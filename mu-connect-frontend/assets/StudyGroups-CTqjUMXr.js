import{u as h,U as ns,j as e,a6 as rs,aw as Fs,F as _,K as pe,ap as ve,ax as Ps,d as y,H as U,D as we,b as be,aK as Is,M as ze,e as Fe,m as Ge,f as Pe,g as ne,c as p,a7 as os,B as F,a8 as ls,ai as cs,x as ke,aj as ds,ak as Te,z as us,E as De,W as G,X as D,R as K,S as Oe,a9 as ms,N as hs,aO as Ms,al as Re,h as Ce,aA as Ls,aB as Ws,aC as es,n as As,Q as Es,Y as Js,aa as Bs,aP as Ns,V as $s,aQ as Ys,a1 as ss,aD as Hs,aE as ts,aR as Us,aF as qs,aG as Vs,am as H,at as Qs}from"./chakra-BFMGxYLr.js";import{y as X,f as Ie,aa as Ks,ab as Xs,ag as Zs,I as et,S as st,a9 as tt,a0 as ps,al as xs,V as gs,p as it,u as at,q as nt,U as rt,T as ot,H as is,Q as lt,c as ct}from"./index-Dge-MEAl.js";import{u as dt,a as c}from"./react-6s1XWRBU.js";import{f as as}from"./courseService-3S11OU7p.js";const fe=async(i={})=>(await X.get("/study-groups",{params:i})).data,ut=async i=>(await X.post("/study-groups",i)).data,mt=async i=>(await X.post(`/study-groups/${i}/join`)).data,ht=async i=>(await X.post(`/study-groups/${i}/leave`)).data,Se=async(i={})=>(await X.get("/study-groups/my-groups",{params:i})).data,pt=async(i,d)=>(await X.put(`/study-groups/${i}`,d)).data,xt=async i=>(await X.delete(`/study-groups/${i}`)).data,gt=rs(os),jt=({group:i,onJoinLeave:d,onEdit:u,onDelete:f,currentUser:O})=>{const k=h("white","gray.700"),T=h("gray.800","white"),S=h("gray.500","gray.400"),P=h("gray.100","gray.600"),v=h("gray.200","gray.700"),L=ns(),q=O&&i.creator&&O.id===i.creator.id,g=()=>{const R=`${window.location.origin}/study-groups/${i.id}`;navigator.share?navigator.share({title:`Join "${i.name}" Study Group`,text:`Join our study group for ${i.course}`,url:R}).catch(()=>{navigator.clipboard.writeText(R),L({title:"Link copied to clipboard",status:"success",duration:2e3})}):(navigator.clipboard.writeText(R),L({title:"Group link copied to clipboard",status:"success",duration:2e3}))};return e.jsxs(gt,{bg:k,boxShadow:"md",borderRadius:"lg",overflow:"hidden",whileHover:{y:-5},transition:{duration:.2},children:[e.jsx(Fs,{children:e.jsxs(_,{justify:"space-between",align:"center",children:[e.jsx(pe,{size:"md",color:T,children:i.name||"Untitled Group"}),e.jsx(ve,{colorScheme:"blue",children:i.course||"Unknown Course"})]})}),e.jsxs(Ps,{children:[e.jsx(y,{color:T,mb:3,noOfLines:2,children:i.description}),e.jsx(U,{spacing:2,mb:4,flexWrap:"wrap",children:(i.tags||[]).map((R,Z)=>e.jsx(ve,{size:"sm",colorScheme:"gray",borderRadius:"full",children:R},Z))}),e.jsx(we,{my:4,borderColor:v}),e.jsxs(be,{spacing:3,children:[e.jsxs(_,{align:"center",color:S,children:[e.jsx(Ie,{style:{marginRight:"8px"}}),e.jsxs(y,{children:[i.members||0," / ",i.capacity||15," Members"]})]}),e.jsxs(_,{align:"center",color:S,children:[e.jsx(Ks,{style:{marginRight:"8px"}}),e.jsxs(y,{children:["Session: ",i.formattedTime||"TBD"]})]}),e.jsxs(_,{align:"center",color:S,children:[e.jsx(Xs,{style:{marginRight:"8px"}}),e.jsx(y,{noOfLines:1,children:i.location||"TBD"})]})]})]}),e.jsx(Is,{pt:0,borderTop:"1px solid",borderColor:v,children:e.jsxs(_,{justify:"space-between",align:"center",w:"full",children:[e.jsxs(ze,{children:[e.jsx(Fe,{as:Ge,"aria-label":"Options",icon:e.jsx(Zs,{}),variant:"ghost",size:"sm",borderRadius:"full",_hover:{bg:P}}),e.jsxs(Pe,{children:[q&&e.jsxs(e.Fragment,{children:[e.jsx(ne,{icon:e.jsx(et,{}),onClick:()=>u&&u(i),children:"Edit Group"}),e.jsx(ne,{icon:e.jsx(st,{}),onClick:()=>f&&f(i),color:"red.500",_hover:{bg:"red.50"},children:"Delete Group"})]}),e.jsx(ne,{icon:e.jsx(tt,{}),onClick:g,children:"Share Group Link"})]})]}),e.jsx(p,{colorScheme:i.isJoined?"red":"blue",variant:i.isJoined?"outline":"solid",size:"sm",borderRadius:"full",onClick:()=>d(i.id),leftIcon:i.isJoined?void 0:e.jsx(ps,{}),children:i.isJoined?"Leave Group":"Join Group"})]})})]})},ft=({type:i="filter",title:d,message:u})=>{const f=h("gray.500","gray.400"),O={filter:"No study groups found",myGroups:"You haven't joined any study groups yet"},k={filter:"Try changing your search terms or filters",myGroups:"Join a study group to collaborate with others and improve your learning"},T=d||O[i],S=u||k[i];return e.jsx(_,{direction:"column",align:"center",justify:"center",py:10,children:e.jsxs(F,{textAlign:"center",maxW:"400px",children:[i==="filter"?e.jsx(xs,{size:50,style:{margin:"0 auto 20px",opacity:.3}}):e.jsx(Ie,{size:50,style:{margin:"0 auto 20px",opacity:.3}}),e.jsx(pe,{size:"md",mb:2,children:T}),e.jsx(y,{color:f,mb:6,children:S})]})})},bt=({groups:i,onJoinLeave:d,onEdit:u,onDelete:f,currentUser:O,emptyStateType:k})=>i.length===0?e.jsx(ft,{type:k}):e.jsx(ls,{columns:{base:1,md:2},spacing:6,children:i.map(T=>e.jsx(jt,{group:T,onJoinLeave:d,onEdit:u,onDelete:f,currentUser:O},T.id))}),yt=({isOpen:i,onClose:d,newGroup:u,onInputChange:f,onCreateGroup:O,courses:k=[],coursesLoading:T=!1,currentCoursePage:S=1,totalCoursePages:P=1,onCoursePageChange:v=()=>{}})=>{const L=h("gray.200","gray.700"),q=h("gray.500","gray.400");return e.jsxs(cs,{isOpen:i,onClose:d,size:"lg",isCentered:!0,children:[e.jsx(ke,{}),e.jsxs(ds,{borderRadius:"xl",children:[e.jsx(Te,{borderBottomWidth:"1px",borderColor:L,pb:4,children:e.jsx(pe,{size:"md",children:"Create a New Study Group"})}),e.jsx(us,{}),e.jsx(De,{py:6,children:e.jsxs(be,{spacing:5,children:[e.jsxs(G,{isRequired:!0,children:[e.jsx(D,{fontWeight:"medium",children:"Group Name"}),e.jsx(K,{name:"name",value:u.name,onChange:f,placeholder:"e.g., Calculus II Problem Solvers",borderRadius:"md"})]}),e.jsxs(G,{isRequired:!0,children:[e.jsx(D,{fontWeight:"medium",children:"Course"}),e.jsxs(ze,{children:[e.jsx(Fe,{as:p,rightIcon:e.jsx(gs,{}),w:"100%",textAlign:"left",fontWeight:"normal",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",children:u.course_id&&k.length>0&&k.find(g=>g.id===Number(u.course_id))?`${k.find(g=>g.id===Number(u.course_id)).code} - ${k.find(g=>g.id===Number(u.course_id)).title}`:"Select course"}),e.jsxs(Pe,{maxH:"320px",overflowY:"auto",minW:"400px",children:[T?e.jsx(_,{justify:"center",align:"center",h:"100px",children:e.jsx(Oe,{})}):k.map(g=>{var R;return e.jsx(ne,{onClick:()=>f({target:{name:"course_id",value:g.id}}),children:e.jsxs(F,{children:[e.jsxs(y,{fontWeight:"medium",children:[g.code," - ",g.title]}),e.jsx(y,{fontSize:"sm",color:q,children:(R=g.major)==null?void 0:R.name})]})},g.id)}),P>1&&e.jsx(F,{borderTop:"1px solid",borderColor:L,mt:2,pt:2,px:2,children:e.jsxs(_,{justify:"space-between",align:"center",children:[e.jsx(p,{size:"xs",onClick:g=>{g.stopPropagation(),v(S-1)},isDisabled:S<=1||T,variant:"outline",borderRadius:"md",children:"Prev"}),e.jsxs(y,{fontSize:"xs",color:q,mx:2,children:["Page ",S," of ",P]}),e.jsx(p,{size:"xs",onClick:g=>{g.stopPropagation(),v(S+1)},isDisabled:S>=P||T,variant:"outline",borderRadius:"md",children:"Next"})]})})]})]})]}),e.jsxs(G,{isRequired:!0,children:[e.jsx(D,{fontWeight:"medium",children:"Description"}),e.jsx(ms,{name:"description",value:u.description,onChange:f,placeholder:"Describe the purpose, goals, and activities of your study group...",borderRadius:"md",minHeight:"120px"})]}),e.jsxs(hs,{templateColumns:{base:"1fr",md:"1fr 1fr"},gap:4,children:[e.jsxs(G,{isRequired:!0,children:[e.jsx(D,{fontWeight:"medium",children:"Meeting Time"}),e.jsx(K,{type:"datetime-local",name:"meeting_time",value:u.meeting_time,onChange:f,borderRadius:"md"})]}),e.jsxs(G,{children:[e.jsx(D,{fontWeight:"medium",children:"Location"}),e.jsx(K,{name:"location",value:u.location,onChange:f,placeholder:"e.g., Library Room 201",borderRadius:"md",isDisabled:u.isOnline})]})]}),e.jsx(G,{children:e.jsx(Ms,{name:"isOnline",isChecked:u.isOnline,onChange:f,children:"This is an online meeting"})})]})}),e.jsxs(Re,{borderTopWidth:"1px",borderColor:L,pt:4,children:[e.jsx(p,{variant:"ghost",mr:3,onClick:d,borderRadius:"md",children:"Cancel"}),e.jsx(p,{colorScheme:"blue",leftIcon:e.jsx(it,{}),onClick:O,isDisabled:!u.name||!u.course_id||!u.description||!u.meeting_time||!u.isOnline&&!u.location,borderRadius:"md",children:"Create Group"})]})]})]})};rs(os);const he=(i,d)=>{if(!i)return"Unknown Course";if(typeof i=="string")return i;if(i.code)return`${i.code}`;const u=d.find(f=>f.id===i);return u?`${u.code} - ${u.title}`:"Unknown Course"},ae=i=>i?new Date(i).toLocaleString("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"TBD",wt=()=>{const i=dt(),d=ns(),{isOpen:u,onOpen:f,onClose:O}=Ce(),{user:k}=at(),{isOpen:T,onOpen:S,onClose:P}=Ce(),[v,L]=c.useState(null),q=c.useRef(),{isOpen:g,onOpen:R,onClose:Z}=Ce(),[ee,Me]=c.useState(null),[b,V]=c.useState({}),js=h("white","gray.700"),Le=h("gray.800","white"),W=h("gray.500","gray.400"),We=h("blue.500","blue.300");h("gray.100","gray.600");const re=h("gray.200","gray.700"),[w,Ae]=c.useState(""),[Ee,fs]=c.useState(0),[Je,bs]=c.useState(!1),[xe,Q]=c.useState([]),[se,te]=c.useState([]),[C,Be]=c.useState([]),[ge,je]=c.useState(!1),[ie,Ne]=c.useState(1),[oe,$e]=c.useState(1),[ys,le]=c.useState(!0),[_s,E]=c.useState(!1),[A,Ye]=c.useState(!1),[J,ce]=c.useState(1),[I,He]=c.useState(1),[Cs,Ue]=c.useState(0),[x,qe]=c.useState({is_online:null,is_complete:null,course_id:""}),[B,ye]=c.useState({name:"",course_id:"",description:"",meeting_time:"",location:"",isOnline:!1}),_e=async s=>{if(!(s<1||s>oe)){je(!0);try{const t=localStorage.getItem("major_id"),r=localStorage.getItem("faculty_id"),a={...t?{major_id:t}:r?{faculty_id:r}:{},page:s,per_page:10},l=await as(a);Be(l.data||[]),Ne(l.current_page||s),$e(l.last_page||1)}catch(t){N("Failed to fetch courses",t)}finally{je(!1)}}},Ss=s=>{ye(t=>({...t,isOnline:s.target.checked,location:s.target.checked?"":t.location}))},vs=s=>{const{name:t,value:r,type:a,checked:l}=s.target;ye(m=>({...m,[t]:a==="checkbox"?l:r}))};c.useEffect(()=>{(async()=>{le(!0),E(!0),je(!0);try{const t=localStorage.getItem("major_id"),r=localStorage.getItem("faculty_id");let a={};t?a.major_id=t:r&&(a.faculty_id=r);const[l,m,j]=await Promise.all([fe(a),Se(),as({...t?{major_id:t}:r?{faculty_id:r}:{},page:1,per_page:10})]);Be(j.data||[]),Ne(j.current_page||1),$e(j.last_page||1);const z=o=>({...o,meetings:o.meeting_time?[o.meeting_time]:[],members:o.members_count||1,tags:o.major?[o.major.name]:[],leader:o.creator||{},course:he(o.course,j.data||[]),formattedTime:ae(o.meeting_time),isPast:o.meeting_time?new Date(o.meeting_time)<new Date:!1}),M=Array.isArray(m)?m:m.data||[],Y=new Set(M.map(o=>o.id));Q(l.data.map(o=>({...z(o),isJoined:Y.has(o.id)}))),l.current_page!==void 0&&(ce(l.current_page),He(l.last_page||1),Ue(l.total||0)),te(M.map(o=>({...z(o),isJoined:!0})))}catch(t){N("Failed to load data",t)}finally{le(!1),E(!1),je(!1)}})()},[]);const N=(s,t)=>{var r,a;d({title:s,description:((a=(r=t==null?void 0:t.response)==null?void 0:r.data)==null?void 0:a.message)||t.message||"Unknown error",status:"error",duration:4e3,isClosable:!0})},$=c.useCallback(async(s=w,t=x,r=1)=>{Ye(!0);try{const a=localStorage.getItem("major_id"),l=localStorage.getItem("faculty_id"),m={...s.trim()&&{q:s.trim()},...t,...a&&{major_id:a},...l&&{faculty_id:l},page:r,per_page:4};Object.keys(m).forEach(n=>{(m[n]===""||m[n]===null)&&delete m[n]});const j=await fe(m),z=n=>({...n,meetings:n.meeting_time?[n.meeting_time]:[],members:n.members_count||1,tags:n.major?[n.major.name]:[],leader:n.creator||{},course:he(n.course,C),formattedTime:ae(n.meeting_time),isPast:n.meeting_time?new Date(n.meeting_time)<new Date:!1}),M=Array.isArray(se)?se:[],Y=new Set(M.map(n=>n.id)),o=(j.data||j).map(n=>({...z(n),isJoined:Y.has(n.id)}));Q(o),j.current_page!==void 0&&(ce(j.current_page),He(j.last_page||1),Ue(j.total||0))}catch(a){N("Search failed",a)}finally{Ye(!1)}},[w,x,C,se]),de=c.useCallback((s,t)=>{const r={...x,[s]:t};qe(r),ce(1),$(w,r,1)},[x,w,$]),ws=c.useCallback(()=>{const s={is_online:null,is_complete:null,course_id:""};qe(s),ce(1),$(w,s,1)},[w,$]),ue=c.useCallback(s=>{ce(s),$(w,x,s)},[w,x,$]);c.useEffect(()=>{const s=setTimeout(()=>{$()},500);return()=>clearTimeout(s)},[w,$]);const Ve=c.useMemo(()=>xe,[xe]),Qe=c.useMemo(()=>{if(!w)return se;const s=w.toLowerCase();return se.filter(t=>t.name.toLowerCase().includes(s)||t.course.toLowerCase().includes(s)||t.description.toLowerCase().includes(s))},[se,w]),Gs=c.useCallback(async s=>{try{const t=xe.find(n=>n.id===s);if(t.isPast){d({title:"Cannot join past session",status:"error",duration:3e3});return}await mt(s),E(!0);const r=localStorage.getItem("major_id"),a=localStorage.getItem("faculty_id");let l={};r?l.major_id=r:a&&(l.faculty_id=a);const[m,j]=await Promise.all([fe(l),Se()]),z={};m.data.forEach(n=>{z[n.id]={...n,members_count:n.members_count}});const M=n=>{const me=z[n.id];return{...n,meetings:n.meeting_time?[n.meeting_time]:[],members:me?me.members_count||1:n.members_count||1,tags:n.major?[n.major.name]:[],leader:n.creator||{},course:he(n.course,C),formattedTime:ae(n.meeting_time),isPast:n.meeting_time?new Date(n.meeting_time)<new Date:!1}},Y=Array.isArray(j)?j:j.data||[],o=new Set(Y.map(n=>n.id));Q(m.data.map(n=>({...M(n),isJoined:o.has(n.id)}))),te(Y.map(n=>{const me=z[n.id];return{...M(n),members:me?me.members_count||1:n.members_count||1,isJoined:!0}})),E(!1),d({title:`Joined ${t.name}`,status:"success"})}catch(t){N("Failed to join group",t),E(!1)}},[xe,C]),ks=c.useCallback(async s=>{try{const t=await ht(s);le(!0),E(!0);const r=localStorage.getItem("major_id"),a=localStorage.getItem("faculty_id");let l={};r?l.major_id=r:a&&(l.faculty_id=a);const[m,j]=await Promise.all([fe(l),Se()]),z=o=>({...o,meetings:o.meeting_time?[o.meeting_time]:[],members:o.members_count||1,tags:o.major?[o.major.name]:[],leader:o.creator||{},course:he(o.course,C),formattedTime:ae(o.meeting_time),isPast:o.meeting_time?new Date(o.meeting_time)<new Date:!1}),M=Array.isArray(j)?j:j.data||[],Y=new Set(M.map(o=>o.id));Q(m.data.map(o=>({...z(o),isJoined:Y.has(o.id)}))),te(M.map(o=>({...z(o),isJoined:!0}))),le(!1),E(!1),t&&t.message&&t.message.includes("The group has been deleted")?d({title:"Group deleted",description:t.message,status:"info",duration:4e3}):d({title:"Left group",description:(t==null?void 0:t.message)||void 0,status:"info",duration:3e3})}catch(t){N("Failed to leave group",t),le(!1),E(!1)}},[C]),Ts=c.useCallback(async()=>{try{const s=localStorage.getItem("major_id"),t=localStorage.getItem("faculty_id");if(!s||!t){d({title:"Missing Profile Information",description:"Please complete your profile (major and faculty) before creating a group.",status:"error",duration:4e3});return}const r={...B,course_id:parseInt(B.course_id),meeting_time:B.meeting_time,capacity:15,is_online:B.isOnline,location:B.isOnline?"Online":B.location,major_id:parseInt(s),faculty_id:parseInt(t)},a=await ut(r);d({title:"Group created!",status:"success"}),O(),ye({name:"",course_id:"",description:"",meeting_time:"",location:"",isOnline:!1});const l={...a,meetings:a.meeting_time?[a.meeting_time]:[],tags:a.major?[a.major.name]:[],formattedTime:ae(a.meeting_time),isPast:a.meeting_time?new Date(a.meeting_time)<new Date:!1,isJoined:!0,members:1,course:he(a.course,C),capacity:a.capacity||15};Q(m=>[l,...m]),te(m=>[l,...m])}catch(s){N("Failed to create group",s)}},[B,C]),Ds=c.useCallback(s=>{Me(s),V({name:s.name,description:s.description,meeting_time:s.meeting_time?new Date(s.meeting_time).toISOString().slice(0,16):"",location:s.location||"",isOnline:s.isOnline||!1}),R()},[R]),Os=c.useCallback(s=>{L(s),S()},[S]),Rs=c.useCallback(async()=>{if(v)try{await xt(v.id),Q(s=>s.filter(t=>t.id!==v.id)),te(s=>s.filter(t=>t.id!==v.id)),d({title:"Group deleted",description:"The study group has been successfully deleted.",status:"success",duration:3e3})}catch(s){N("Failed to delete group",s)}finally{P(),L(null)}},[v,P,d]),zs=c.useCallback(async()=>{if(!ee||!b.name||!b.description){d({title:"Please fill in all required fields",status:"error",duration:3e3});return}try{const s={name:b.name,description:b.description,meeting_time:b.meeting_time||null,location:b.isOnline?"Online":b.location,is_online:b.isOnline};await pt(ee.id,s);const t={...ee,...s,formattedTime:ae(b.meeting_time)};Q(r=>r.map(a=>a.id===ee.id?t:a)),te(r=>r.map(a=>a.id===ee.id?t:a)),d({title:"Group updated",description:"The study group has been successfully updated.",status:"success",duration:3e3}),Z(),Me(null),V({})}catch(s){N("Failed to update group",s)}},[ee,b,Z,d]),Ke=(s,t=!1)=>e.jsx(bt,{groups:s,onJoinLeave:r=>{const a=s.find(l=>l.id===r);a&&a.isJoined?ks(r):Gs(r)},onEdit:Ds,onDelete:Os,currentUser:k,emptyStateType:t?"myGroups":"allGroups"}),Xe=(s,t,r)=>e.jsx(_,{direction:"column",align:"center",justify:"center",py:10,children:e.jsxs(F,{textAlign:"center",maxW:"400px",children:[s,e.jsx(pe,{size:"md",mb:2,children:t}),e.jsx(y,{color:W,mb:6,children:r}),Ee===0&&e.jsx(p,{colorScheme:"blue",onClick:f,children:"Create Your First Group"})]})}),Ze=()=>e.jsx(ls,{columns:{base:1,md:2},spacing:6,children:[...Array(4)].map((s,t)=>e.jsxs(F,{p:6,bg:js,borderRadius:"lg",boxShadow:"md",children:[e.jsx(H,{height:"32px",mb:4}),e.jsx(Qs,{noOfLines:3,spacing:"4"}),e.jsxs(U,{mt:4,spacing:2,children:[e.jsx(H,{height:"24px",width:"60px"}),e.jsx(H,{height:"24px",width:"60px"})]}),e.jsx(we,{my:4}),e.jsxs(be,{spacing:3,children:[e.jsx(H,{height:"20px"}),e.jsx(H,{height:"20px"}),e.jsx(H,{height:"20px"})]}),e.jsx(we,{my:4}),e.jsxs(_,{justify:"space-between",mt:4,children:[e.jsx(H,{height:"32px",width:"100px"}),e.jsx(H,{height:"32px",width:"100px"})]})]},t))});return e.jsxs(_,{minH:"100vh",p:{base:4,md:8},bg:h("gray.50","gray.800"),children:[e.jsxs(F,{maxW:"container.lg",mx:"auto",w:"full",children:[e.jsxs(_,{justify:"space-between",align:"center",mb:6,flexWrap:"wrap",gap:4,children:[e.jsxs(U,{spacing:4,children:[e.jsx(Ge,{icon:e.jsx(nt,{}),"aria-label":"Go back",onClick:()=>i(-1),variant:"ghost",borderRadius:"full"}),e.jsx(pe,{size:"xl",color:Le,fontWeight:"700",children:"Study Groups"})]}),e.jsx(p,{leftIcon:e.jsx(ps,{}),colorScheme:"blue",onClick:f,borderRadius:"full",children:"Create Group"})]}),e.jsxs(Ls,{colorScheme:"blue",mb:6,variant:"soft-rounded",index:Ee,onChange:fs,children:[e.jsxs(_,{justify:"space-between",align:"center",gap:4,mb:4,flexWrap:"wrap",children:[e.jsxs(Ws,{children:[e.jsx(es,{children:"All Groups"}),e.jsx(es,{children:"My Groups"})]}),e.jsxs(U,{spacing:2,children:[e.jsxs(p,{leftIcon:e.jsx(rt,{}),variant:"outline",size:"sm",onClick:()=>bs(!Je),colorScheme:Object.values(x).some(s=>s!==null&&s!=="")?"blue":"gray",children:["Filters",Object.values(x).some(s=>s!==null&&s!=="")&&e.jsx(As,{ml:2,colorScheme:"blue",variant:"solid",children:Object.values(x).filter(s=>s!==null&&s!=="").length})]}),e.jsxs(Es,{maxW:{base:"250px",md:"300px"},children:[e.jsx(Js,{pointerEvents:"none",children:e.jsx(ot,{color:W})}),e.jsx(K,{placeholder:"Search study sessions...",size:"md",borderRadius:"lg",value:w,onChange:s=>Ae(s.target.value),_focus:{borderColor:We,boxShadow:`0 0 0 1px ${We}`},bg:h("white","gray.700")}),(w||A)&&e.jsx(Bs,{children:A?e.jsx(Oe,{size:"sm"}):e.jsx(Ge,{icon:e.jsx(is,{}),size:"sm",variant:"ghost","aria-label":"Clear search",onClick:()=>Ae("")})})]})]})]}),e.jsx(Ns,{in:Je,animateOpacity:!0,children:e.jsx(F,{p:4,bg:h("gray.50","gray.700"),borderRadius:"lg",mb:4,border:"1px solid",borderColor:re,children:e.jsxs($s,{spacing:4,align:"stretch",children:[e.jsxs(U,{justify:"space-between",align:"center",children:[e.jsx(y,{fontWeight:"medium",fontSize:"sm",color:Le,children:"Filter Groups"}),e.jsx(p,{size:"xs",variant:"ghost",onClick:ws,disabled:!Object.values(x).some(s=>s!==null&&s!==""),children:"Clear All"})]}),"                ",e.jsxs(hs,{templateColumns:{base:"1fr",md:"repeat(2, 1fr)",lg:"repeat(3, 1fr)"},gap:4,children:[e.jsxs(G,{children:[e.jsx(D,{fontSize:"sm",mb:1,children:"Course"}),e.jsxs(ze,{children:[e.jsx(Fe,{as:p,size:"sm",w:"100%",rightIcon:e.jsx(gs,{}),textAlign:"left",fontWeight:"normal",bg:h("white","gray.600"),overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",children:x.course_id&&C.find(s=>s.id===Number(x.course_id))?`${C.find(s=>s.id===Number(x.course_id)).code} - ${C.find(s=>s.id===Number(x.course_id)).title}`:"Any course"}),e.jsx(Ys,{children:e.jsxs(Pe,{maxH:"320px",overflowY:"auto",minW:"400px",children:[e.jsx(ne,{onClick:()=>de("course_id",""),children:"Any course"}),ge?e.jsx(_,{justify:"center",align:"center",h:"100px",children:e.jsx(Oe,{})}):C.map(s=>{var t;return e.jsx(ne,{onClick:()=>de("course_id",s.id),children:e.jsxs(F,{children:[e.jsxs(y,{fontWeight:"medium",children:[s.code," - ",s.title]}),e.jsx(y,{fontSize:"sm",color:W,children:(t=s.major)==null?void 0:t.name})]})},s.id)}),oe>1&&e.jsx(F,{borderTop:"1px solid",borderColor:re,mt:2,pt:2,px:2,children:e.jsxs(_,{justify:"space-between",align:"center",children:[e.jsx(p,{size:"xs",onClick:s=>{s.stopPropagation(),_e(ie-1)},isDisabled:ie<=1||ge,variant:"outline",borderRadius:"md",children:"Prev"}),e.jsxs(y,{fontSize:"xs",color:W,mx:2,children:["Page ",ie," of ",oe]}),e.jsx(p,{size:"xs",onClick:s=>{s.stopPropagation(),_e(ie+1)},isDisabled:ie>=oe||ge,variant:"outline",borderRadius:"md",children:"Next"})]})})]})})]})]}),e.jsxs(G,{children:[e.jsx(D,{fontSize:"sm",mb:1,children:"Meeting Type"}),e.jsxs(ss,{size:"sm",value:x.is_online===null?"":x.is_online.toString(),onChange:s=>de("is_online",s.target.value===""?null:s.target.value==="true"),placeholder:"Any type",bg:h("white","gray.600"),children:[e.jsx("option",{value:"true",children:"Online"}),e.jsx("option",{value:"false",children:"In-person"})]})]}),e.jsxs(G,{children:[e.jsx(D,{fontSize:"sm",mb:1,children:"Status"}),e.jsxs(ss,{size:"sm",value:x.is_complete===null?"":x.is_complete.toString(),onChange:s=>de("is_complete",s.target.value===""?null:s.target.value==="true"),placeholder:"Any status",bg:h("white","gray.600"),children:[e.jsx("option",{value:"false",children:"Active"}),e.jsx("option",{value:"true",children:"Completed"})]})]})]}),Object.entries(x).some(([s,t])=>t!==null&&t!=="")&&e.jsxs(F,{children:[e.jsx(y,{fontSize:"xs",color:W,mb:2,children:"Active Filters:"}),e.jsx(U,{spacing:2,flexWrap:"wrap",children:Object.entries(x).map(([s,t])=>{if(t===null||t==="")return null;let r="",a=t;switch(s){case"course_id":const l=C.find(m=>m.id.toString()===t.toString());r="Course",a=l?l.code:t;break;case"is_online":r="Type",a=t?"Online":"In-person";break;case"is_complete":r="Status",a=t?"Completed":"Active";break}return e.jsxs(ve,{size:"sm",colorScheme:"blue",variant:"solid",cursor:"pointer",onClick:()=>de(s,s==="is_online"||s==="is_complete"?null:""),children:[r,": ",a,e.jsx(is,{style:{marginLeft:"4px"}})]},s)})})]})]})})}),e.jsxs(Hs,{children:[e.jsx(ts,{px:0,children:ys?Ze():Ve.length>0?e.jsxs(e.Fragment,{children:[Ke(Ve),I>1&&e.jsxs(F,{mt:8,children:[e.jsx(_,{justify:"center",mb:4,display:{base:"flex",md:"none"},children:e.jsxs(y,{fontSize:"sm",color:W,textAlign:"center",px:4,children:["Page ",J," of ",I]})}),e.jsxs(_,{justify:"space-between",align:"center",p:6,bg:h("white","gray.700"),borderRadius:"xl",borderWidth:"1px",borderColor:re,shadow:"sm",_hover:{shadow:"md",borderColor:h("gray.300","gray.600")},transition:"all 0.2s",flexDirection:{base:"column",md:"row"},gap:{base:4,md:0},children:[e.jsxs(y,{fontSize:"sm",color:W,fontWeight:"medium",display:{base:"none",md:"block"},children:["Showing page ",J," of ",I," â€¢ ",Cs," total groups"]}),e.jsxs(U,{spacing:2,children:[e.jsx(p,{leftIcon:e.jsx(lt,{}),onClick:()=>ue(J-1),isDisabled:J===1||A,variant:"outline",size:"md",borderRadius:"lg",_hover:{bg:h("blue.50","blue.900"),borderColor:"blue.300",transform:"translateY(-1px)"},_active:{transform:"translateY(0)"},transition:"all 0.2s",isLoading:A,loadingText:"Previous",children:"Previous"}),e.jsx(U,{spacing:1,mx:2,children:(()=>{const s=[],t=window.innerWidth<768?3:5;let r=Math.max(1,J-Math.floor(t/2)),a=Math.min(I,r+t-1);a-r+1<t&&(r=Math.max(1,a-t+1)),r>1&&(s.push(e.jsx(p,{onClick:()=>ue(1),isDisabled:A,variant:"outline",size:"md",minW:"44px",h:"44px",borderRadius:"lg",_hover:{bg:h("blue.50","blue.900"),borderColor:"blue.300",transform:"translateY(-1px)"},_active:{transform:"translateY(0)"},transition:"all 0.2s",children:"1"},1)),r>2&&s.push(e.jsx(y,{color:W,px:2,fontSize:"lg",children:"..."},"ellipsis1")));for(let l=r;l<=a;l++){const m=l===J;s.push(e.jsx(p,{onClick:()=>ue(l),isDisabled:A,colorScheme:m?"blue":void 0,variant:m?"solid":"outline",size:"md",minW:"44px",h:"44px",borderRadius:"lg",fontWeight:m?"bold":"medium",_hover:m?{}:{bg:h("blue.50","blue.900"),borderColor:"blue.300",transform:"translateY(-1px)"},_active:{transform:"translateY(0)"},transition:"all 0.2s",shadow:m?"md":"sm",children:l},l))}return a<I&&(a<I-1&&s.push(e.jsx(y,{color:W,px:2,fontSize:"lg",children:"..."},"ellipsis2")),s.push(e.jsx(p,{onClick:()=>ue(I),isDisabled:A,variant:"outline",size:"md",minW:"44px",h:"44px",borderRadius:"lg",_hover:{bg:h("blue.50","blue.900"),borderColor:"blue.300",transform:"translateY(-1px)"},_active:{transform:"translateY(0)"},transition:"all 0.2s",children:I},I))),s})()}),e.jsx(p,{rightIcon:e.jsx(ct,{}),onClick:()=>ue(J+1),isDisabled:J===I||A,variant:"outline",size:"md",borderRadius:"lg",_hover:{bg:h("blue.50","blue.900"),borderColor:"blue.300",transform:"translateY(-1px)"},_active:{transform:"translateY(0)"},transition:"all 0.2s",isLoading:A,loadingText:"Next",children:"Next"})]})]})]})]}):Xe(e.jsx(xs,{size:50,style:{margin:"0 auto 20px",opacity:.3}}),"No study groups found","Try changing your search terms or create a new group")}),e.jsx(ts,{px:0,children:_s?Ze():Qe.length>0?Ke(Qe,!0):Xe(e.jsx(Ie,{size:50,style:{margin:"0 auto 20px",opacity:.3}}),"You haven't joined any groups yet","Join a study group to collaborate with others")})]})]})]}),e.jsx(yt,{isOpen:u,onClose:O,newGroup:B,onInputChange:vs,onCreateGroup:Ts,onToggleOnline:Ss,subjects:["All",...new Set(C.map(s=>{var t;return(t=s.major)==null?void 0:t.name}).filter(Boolean))],courses:C,coursesLoading:ge,currentCoursePage:ie,totalCoursePages:oe,onCoursePageChange:_e}),e.jsxs(cs,{isOpen:g,onClose:Z,size:"lg",isCentered:!0,children:[e.jsx(ke,{}),e.jsxs(ds,{borderRadius:"xl",children:[e.jsx(Te,{borderBottomWidth:"1px",borderColor:re,pb:4,children:"Edit Study Group"}),e.jsx(us,{}),e.jsx(De,{py:6,children:e.jsxs(be,{spacing:4,children:[e.jsxs(G,{isRequired:!0,children:[e.jsx(D,{children:"Group Name"}),e.jsx(K,{value:b.name||"",onChange:s=>V(t=>({...t,name:s.target.value})),placeholder:"Enter group name"})]}),e.jsxs(G,{isRequired:!0,children:[e.jsx(D,{children:"Description"}),e.jsx(ms,{value:b.description||"",onChange:s=>V(t=>({...t,description:s.target.value})),placeholder:"Describe your study group",rows:3})]}),e.jsxs(G,{children:[e.jsx(D,{children:"Meeting Time"}),e.jsx(K,{type:"datetime-local",value:b.meeting_time||"",onChange:s=>V(t=>({...t,meeting_time:s.target.value}))})]}),e.jsxs(G,{display:"flex",alignItems:"center",children:[e.jsx(D,{mb:"0",children:"Online Meeting"}),e.jsx(Us,{isChecked:b.isOnline||!1,onChange:s=>V(t=>({...t,isOnline:s.target.checked}))})]}),!b.isOnline&&e.jsxs(G,{children:[e.jsx(D,{children:"Location"}),e.jsx(K,{value:b.location||"",onChange:s=>V(t=>({...t,location:s.target.value})),placeholder:"Enter meeting location"})]})]})}),e.jsxs(Re,{borderTopWidth:"1px",borderColor:re,pt:4,children:[e.jsx(p,{variant:"ghost",mr:3,onClick:Z,children:"Cancel"}),e.jsx(p,{colorScheme:"blue",onClick:zs,isDisabled:!b.name||!b.description,children:"Update Group"})]})]})]}),e.jsx(qs,{isOpen:T,leastDestructiveRef:q,onClose:P,isCentered:!0,children:e.jsx(ke,{children:e.jsxs(Vs,{borderRadius:"xl",children:[e.jsx(Te,{fontSize:"lg",fontWeight:"bold",children:"Delete Study Group"}),e.jsxs(De,{children:['Are you sure you want to delete "',v==null?void 0:v.name,'"? This action cannot be undone and will remove all group data.']}),e.jsxs(Re,{children:[e.jsx(p,{ref:q,onClick:P,children:"Cancel"}),e.jsx(p,{colorScheme:"red",onClick:Rs,ml:3,children:"Delete"})]})]})})})]})};export{wt as default};

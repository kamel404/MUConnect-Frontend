import{y as s}from"./index-Dge-MEAl.js";import"./chakra-BFMGxYLr.js";import"./react-6s1XWRBU.js";const u=()=>localStorage.getItem("authToken"),w=async(o={})=>{var r;try{const e={...o};if(!e.faculty_id||!e.major_id){const c=JSON.parse(localStorage.getItem("user")||"{}");e.faculty_id||(e.faculty_id=c.faculty_id||localStorage.getItem("faculty_id")),e.major_id||(e.major_id=c.major_id||localStorage.getItem("major_id"))}const t=await s.get("/resources",{params:e});if(Array.isArray(t.data))return t.data;if(t.data&&Array.isArray(t.data.data)){const c=t.data.data;return c.pagination=t.data.pagination||null,c}return[]}catch(e){throw((r=e.response)==null?void 0:r.data)||{message:"Failed to fetch resources"}}},$=async o=>{var r;try{const e=await s.get(`/resources/${o}`);return console.log("Resource fetched successfully:",e.data),e.data}catch(e){throw console.error("Error fetching resource:",e),((r=e.response)==null?void 0:r.data)||{message:"Failed to fetch resource"}}},v=async({title:o,description:r,attachments:e,course_id:t,major_id:c,faculty_id:l,type:g,poll:n})=>{var i;try{const a=new FormData;if(o&&a.append("title",o),r&&a.append("description",r),t&&a.append("course_id",t),c&&a.append("major_id",c),l&&a.append("faculty_id",l),g&&a.append("type",g),e&&e.length)for(let d=0;d<e.length;d++)a.append("attachments[]",e[d]);n&&n.question&&n.options&&n.options.length>0&&(a.append("poll[question]",n.question),n.options.forEach(d=>{const m=typeof d=="string"?d.trim():"";m&&a.append("poll[options][]",m)}),console.log("Poll data added to FormData for creation:",n));const p=await s.post("/resources",a,{headers:{"Content-Type":"multipart/form-data"}});return p.data.resource||p.data}catch(a){throw((i=a.response)==null?void 0:i.data)||{message:"Failed to create resource"}}},E=async(o,{title:r,description:e,newAttachments:t,removeAttachmentIds:c})=>{var l,g;try{console.log("Updating resource with ID:",o);const n=new FormData;if(n.append("_method","PUT"),r!==void 0&&(console.log("Setting title:",r),n.append("title",r)),e!==void 0&&(console.log("Setting description:",e),n.append("description",e)),t&&t.length){console.log(`Adding ${t.length} new attachment(s)`);for(let a=0;a<t.length;a++)n.append("attachments[]",t[a]),console.log(`Added attachment: ${t[a].name}`)}if(c){const a=Array.isArray(c)?c:[c];a.length&&(console.log(`Removing ${a.length} attachment(s)`),a.forEach(p=>{p&&(console.log(`Marking attachment for removal: ${p}`),n.append("remove_attachments[]",p.toString()))}))}const i=await s.post(`/resources/${o}`,n);return console.log("Resource updated successfully:",i.data),i.data.resource||i.data}catch(n){throw console.error("Error updating resource:",n),console.error("Error details:",((l=n.response)==null?void 0:l.data)||"Unknown error"),((g=n.response)==null?void 0:g.data)||{message:"Failed to update resource"}}},F=async o=>{try{return(await s.post(`/resources/${o}/toggle-upvote`,{},{headers:{Authorization:`Bearer ${u()}`}})).data}catch(r){throw console.error("Error toggling upvote:",r),r}},_=async(o,r)=>{try{return(await s.post(`/resources/${o}/comments`,{body:r},{headers:{"Content-Type":"application/json",Authorization:`Bearer ${u()}`}})).data}catch(e){throw console.error("Error adding comment:",e),e}},R=async(o,r)=>{try{return(await s.put(`/comments/${o}`,{body:r},{headers:{"Content-Type":"application/json",Authorization:`Bearer ${u()}`}})).data}catch(e){throw console.error("Error updating comment:",e),e}},j=async o=>{try{return(await s.delete(`/comments/${o}`,{headers:{Authorization:`Bearer ${u()}`}})).data}catch(r){throw console.error("Error deleting comment:",r),r}},S=async o=>{var r;try{return(await s.post(`/poll-options/${o}/vote`,{},{headers:{Authorization:`Bearer ${u()}`}})).data}catch(e){throw console.error("Error voting poll option:",e),((r=e.response)==null?void 0:r.data)||{message:"Failed to record vote"}}},z=async o=>{try{return(await s.post(`/comments/${o}/toggle-upvote`,{},{headers:{"Content-Type":"application/json",Authorization:`Bearer ${u()}`}})).data}catch(r){throw console.error("Error toggling comment upvote:",r),r}},C=async o=>{var r;try{return(await s.delete(`/resources/${o}`)).data}catch(e){throw console.error("Error deleting resource:",e),((r=e.response)==null?void 0:r.data)||{message:"Failed to delete resource"}}},T=async o=>{var r;try{return(await s.post(`/resources/${o}/toggleSave`)).data}catch(e){throw((r=e.response)==null?void 0:r.data)||{message:"Failed to save resource"}}},A=async(o={})=>{var r;try{return(await s.get("/saved-items",{params:o})).data}catch(e){throw((r=e.response)==null?void 0:r.data)||{message:"Failed to fetch saved items"}}},B=async o=>{var r;try{return(await s.get("/top-contributors",{params:{limit:o}})).data}catch(e){throw console.error("Error fetching top contributors:",e),((r=e.response)==null?void 0:r.data)||{message:"Failed to fetch top contributors"}}},D=async(o,r=null)=>{var e;try{const t={};return r&&(t.attachment_id=r),(await s.get(`/resources/${o}/generate-quiz`,{params:t})).data}catch(t){throw console.error("Error initiating quiz generation:",t),((e=t.response)==null?void 0:e.data)||{message:"Failed to initiate quiz generation"}}},q=async(o,r=null)=>{var e;try{const t={};return r&&(t.attachment_id=r),(await s.get(`/resources/${o}/generate-summary`,{params:t})).data}catch(t){throw console.error("Error initiating summary generation:",t),((e=t.response)==null?void 0:e.data)||{message:"Failed to initiate summary generation"}}},P=async(o={})=>{var r;try{return(await s.get("/admin/resources/pending",{params:o})).data}catch(e){throw console.error("Error fetching pending resources:",e),((r=e.response)==null?void 0:r.data)||{message:"Failed to fetch pending resources"}}},U=async o=>{var r;try{return(await s.post(`/admin/resources/${o}/approve`)).data}catch(e){throw console.error("Error approving resource:",e),((r=e.response)==null?void 0:r.data)||{message:"Failed to approve resource"}}},b=async(o,r)=>{var e;try{const t=r?{reason:r.trim()}:{};return(await s.post(`/admin/resources/${o}/reject`,t)).data}catch(t){throw console.error("Error rejecting resource:",t),((e=t.response)==null?void 0:e.data)||{message:"Failed to reject resource"}}};export{_ as addComment,U as approveResource,v as createResource,j as deleteComment,C as deleteResource,D as generateQuiz,q as generateSummary,w as getAllResources,P as getPendingResources,$ as getResourceById,A as getSavedItems,B as getTopContributors,b as rejectResource,z as toggleCommentUpvote,T as toggleSaveResource,F as toggleUpvote,R as updateComment,E as updateResource,S as votePollOption};

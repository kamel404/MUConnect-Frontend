import{u as n,j as e,a3 as P,d as o,B as F,J as ie,n as ce,H as d,T as le,m as Z,V as I,K as V,I as j,F as U,A as de,R as he,U as ue,W as ge,c as z,az as xe,aA as je,aB as pe,C as H,L as K,ap as me,av as ve,a1 as be,a2 as fe,aT as ye,aU as Ce,aV as we}from"./chakra-CQE3Mdfe.js";import{u as Se,a as c}from"./react-DDk2FCmG.js";import{G as ke,e as ee,H as ae,I as Re,J as Fe,K as Ie,j as Ee,L as Be,M as Le,N as Ae,O as Te,P as De,Q as _e,R as ze,T as X,D as Pe,U as Ue}from"./index-DPnEyPUk.js";import"./charts-BQajcoWg.js";const Y=P(F),q=({event:i,onBookmark:f,onCardClick:y})=>{const C=n("white","gray.800"),E=n("gray.800","whiteAlpha.900"),w=n("gray.600","gray.400"),B=n("gray.200","gray.700");if(!i||!i.data)return e.jsx(Y,{p:5,borderWidth:"1px",borderRadius:"lg",borderColor:B,bg:C,textAlign:"center",children:e.jsx(o,{color:w,children:"This saved item is no longer available."})});const{title:l,event_datetime:S,location:h,organizer:W,attendees_count:p,image_path:u,is_club_event:m,club:g}=i.data,k=new Date(S)<new Date,L=new Date(S).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"}),G=new Date(S).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",hour12:!0}),M=u?u.startsWith("http")?u:`${ke}/${u}`:null;return e.jsxs(Y,{borderWidth:"1px",borderRadius:"lg",overflow:"hidden",bg:C,borderColor:B,whileHover:{y:-5,boxShadow:"lg"},transition:{type:"spring",stiffness:300},cursor:"pointer",onClick:()=>y(i.data.id),children:[e.jsxs(F,{position:"relative",children:[e.jsx(ie,{src:M,alt:l,objectFit:"cover",w:"100%",h:"200px"}),k&&e.jsx(ce,{position:"absolute",top:2,left:2,colorScheme:"red",children:"Finished"}),e.jsx(d,{position:"absolute",top:2,right:2,spacing:2,children:e.jsx(le,{label:i.isSaved?"Unsave":"Save",placement:"top",children:e.jsx(Z,{icon:e.jsx(ee,{fill:i.isSaved?"currentColor":"none"}),onClick:v=>{v.stopPropagation(),f(i.data.id,"Event")},size:"sm",borderRadius:"full",bg:"rgba(0,0,0,0.6)",color:"white",_hover:{bg:"rgba(0,0,0,0.8)"},"aria-label":"Bookmark Event"})})})]}),e.jsxs(I,{p:4,align:"start",spacing:3,children:[e.jsx(V,{size:"md",color:E,noOfLines:2,children:l}),e.jsxs(I,{align:"start",spacing:2,color:w,children:[e.jsxs(d,{children:[e.jsx(j,{as:ae}),e.jsx(o,{children:L})]}),e.jsxs(d,{children:[e.jsx(j,{as:Re}),e.jsx(o,{children:G})]}),e.jsxs(d,{children:[e.jsx(j,{as:Fe}),e.jsx(o,{children:h})]})]}),e.jsxs(U,{justify:"space-between",align:"center",w:"100%",mt:3,children:[e.jsx(d,{children:m&&g?e.jsxs(e.Fragment,{children:[e.jsx(de,{size:"xs",name:g.name,src:g.logo_path}),e.jsx(o,{fontSize:"sm",fontWeight:"bold",children:g.name})]}):e.jsxs(o,{fontSize:"sm",children:["Organized by: ",W]})}),e.jsxs(d,{spacing:1,align:"center",children:[e.jsx(j,{as:Ie}),e.jsx(o,{fontSize:"sm",children:p})]})]})]})]})},We=[{id:"all",name:"All Items",icon:Te,color:"gray.500"},{id:"Resource",name:"Resources",icon:De,color:"blue.500"},{id:"Event",name:"Events",icon:ae,color:"purple.500"}],Ve=()=>{const i=Se(),[f,y]=c.useState([]),[C,E]=c.useState(!0),[w,B]=c.useState(null),[l,S]=c.useState(""),[h,W]=c.useState("all"),[p,u]=c.useState("grid"),[m,g]=c.useState(1),k=9,[L,G]=c.useState(null),M=n("gray.50","gray.900"),v=n("gray.800","whiteAlpha.900"),x=n("gray.600","gray.400"),A=n("gray.200","gray.700"),R=n("white","gray.800"),se=n("blue.50","blue.900"),te=n("gray.100","gray.700");c.useEffect(()=>{(async()=>{E(!0);try{const a=await _e();G(a);const b=(await ze()).data.map(r=>({...r,isSaved:!0,data:r.type==="Resource"?{...r.data,is_saved:!0}:r.data}));y(b)}catch(a){B("Failed to fetch saved items. Please try again later."),console.error(a)}finally{E(!1)}})()},[]);const T=async(s,a)=>{const t=[...f],b=f.filter(r=>{var J;return((J=r.data)==null?void 0:J.id)!==s});y(b);try{a==="Resource"?await Pe(s):a==="Event"&&await Ue(s)}catch(r){console.error("Failed to update bookmark status:",r),y(t)}},D=(s,a)=>{a==="Resource"?i(`/resources/${s}`):a==="Event"&&i("/events")},_=f.filter(s=>{var b,r;if(!s.data)return h==="all"&&l==="";const a=((b=s.data.title)==null?void 0:b.toLowerCase().includes(l.toLowerCase()))||((r=s.data.description)==null?void 0:r.toLowerCase().includes(l.toLowerCase())),t=h==="all"||s.type===h;return a&&t}).sort((s,a)=>new Date(a.saved_at||0)-new Date(s.saved_at||0)),O=(m-1)*k,N=_.slice(O,O+k),$=Math.ceil(_.length/k),re=()=>{window.history.back()},ne={hidden:{opacity:0},show:{opacity:1,transition:{staggerChildren:.08}}},Q={hidden:{y:20,opacity:0},show:{y:0,opacity:1}},oe=()=>{if(C)return e.jsx(H,{w:"full",py:12,children:e.jsx(K,{templateColumns:{base:"1fr",md:"repeat(2,1fr)",lg:"repeat(3,1fr)"},gap:6,w:"full",children:[...Array(6)].map((a,t)=>e.jsxs(F,{borderWidth:"1px",borderRadius:"lg",p:4,bg:R,borderColor:A,children:[e.jsx(me,{height:"150px",mb:4}),e.jsx(ve,{noOfLines:3,spacing:"4"})]},t))})});if(w)return e.jsx(H,{h:"300px",children:e.jsxs(be,{status:"error",borderRadius:"md",children:[e.jsx(fe,{}),e.jsx(ye,{children:"An Error Occurred!"}),e.jsx(Ce,{children:w})]})});if(_.length===0)return e.jsx(H,{h:"300px",children:e.jsxs(I,{children:[e.jsx(j,{as:ee,boxSize:"50px",color:x}),e.jsx(V,{size:"md",color:v,children:"No Saved Items Found"}),e.jsx(o,{color:x,children:l||h!=="all"?"Try adjusting your search or filter.":"You haven't saved any items yet."})]})});const s={base:"1fr",md:"repeat(2, 1fr)",lg:"repeat(3, 1fr)"};return e.jsx(we,{mode:"wait",children:e.jsx(P.div,{variants:ne,initial:"hidden",animate:"show",children:p==="grid"?e.jsx(K,{templateColumns:s,gap:6,children:N.map(a=>{var t;return e.jsx(P.div,{variants:Q,children:a.type==="Resource"?e.jsx(X,{resource:a.data,onBookmark:()=>T(a.data.id,"Resource"),onCardClick:()=>D(a.data.id,"Resource"),currentUser:L,cardBg:R,textColor:v,mutedText:x,borderColor:A}):e.jsx(q,{event:a,onBookmark:()=>T(a.data.id,"Event"),onCardClick:()=>D(a.data.id,"Event")})},`${a.type}-${((t=a.data)==null?void 0:t.id)||a.saved_at}`)})}):e.jsx(I,{spacing:4,align:"stretch",children:N.map(a=>{var t;return e.jsx(P.div,{variants:Q,children:a.type==="Resource"?e.jsx(X,{resource:a.data,onBookmark:()=>T(a.data.id,"Resource"),onCardClick:()=>D(a.data.id,"Resource"),currentUser:L,cardBg:R,textColor:v,mutedText:x,borderColor:A}):e.jsx(q,{event:a,onBookmark:()=>T(a.data.id,"Event"),onCardClick:()=>D(a.data.id,"Event")})},`${a.type}-${((t=a.data)==null?void 0:t.id)||a.saved_at}`)})})},p)})};return e.jsxs(F,{bg:M,minH:"100vh",p:{base:4,md:8},children:[e.jsxs(U,{mb:4,align:"center",children:[e.jsx(Z,{icon:e.jsx(Ee,{}),"aria-label":"Go back",variant:"ghost",onClick:re}),e.jsx(o,{ml:2,fontWeight:"medium",color:x,children:"Go Back"})]}),e.jsxs(I,{spacing:6,align:"stretch",children:[e.jsxs(U,{direction:{base:"column",md:"row"},justify:"space-between",align:{base:"flex-start",md:"center"},gap:4,children:[e.jsxs(F,{children:[e.jsx(V,{size:"lg",color:v,children:"My Saved Items"}),e.jsx(o,{color:x,children:C?"Loading...":`${_.length} items found`})]}),e.jsxs(U,{gap:2,direction:{base:"column",sm:"row"},w:{base:"100%",md:"auto"},children:[e.jsxs(he,{w:{base:"100%",sm:"250px"},children:[e.jsx(ue,{pointerEvents:"none",children:e.jsx(j,{as:Be,color:x})}),e.jsx(ge,{placeholder:"Search saved items...",value:l,onChange:s=>S(s.target.value),bg:R})]}),e.jsxs(d,{spacing:1,bg:R,borderRadius:"md",p:1,borderWidth:"1px",borderColor:A,children:[e.jsx(z,{size:"sm",variant:p==="grid"?"solid":"ghost",onClick:()=>u("grid"),leftIcon:e.jsx(Le,{}),children:"Grid"}),e.jsx(z,{size:"sm",variant:p==="list"?"solid":"ghost",onClick:()=>u("list"),leftIcon:e.jsx(Ae,{}),children:"List"})]})]})]}),e.jsx(xe,{variant:"soft-rounded",colorScheme:"blue",children:e.jsx(je,{overflowX:"auto",py:2,children:We.map(s=>e.jsxs(pe,{onClick:()=>W(s.id),bg:h===s.id?se:"transparent",_hover:{bg:te},children:[e.jsx(j,{as:s.icon,mr:2,color:s.color}),s.name]},s.id))})}),e.jsxs(e.Fragment,{children:[oe(),$>1&&e.jsxs(d,{justify:"center",spacing:4,mt:4,children:[e.jsx(z,{onClick:()=>g(s=>s-1),isDisabled:m===1,children:"Previous"}),e.jsxs(o,{children:["Page ",m," of ",$]}),e.jsx(z,{onClick:()=>g(s=>s+1),isDisabled:m===$,children:"Next"})]})]})]})]})};export{Ve as default};
